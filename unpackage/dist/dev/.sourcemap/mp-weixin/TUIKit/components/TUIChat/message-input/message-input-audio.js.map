{"version":3,"sources":["webpack:////Users/wangwenle/Documents/有钱花/搭伙/build-fire/TUIKit/components/TUIChat/message-input/message-input-audio.vue?cf9f","webpack:////Users/wangwenle/Documents/有钱花/搭伙/build-fire/TUIKit/components/TUIChat/message-input/message-input-audio.vue?4cb4","webpack:////Users/wangwenle/Documents/有钱花/搭伙/build-fire/TUIKit/components/TUIChat/message-input/message-input-audio.vue?d1b5","webpack:////Users/wangwenle/Documents/有钱花/搭伙/build-fire/TUIKit/components/TUIChat/message-input/message-input-audio.vue?0a77","uni-app:///TUIKit/components/TUIChat/message-input/message-input-audio.vue?vue&type=script&lang=ts&","webpack:////Users/wangwenle/Documents/有钱花/搭伙/build-fire/TUIKit/components/TUIChat/message-input/message-input-audio.vue?641f","webpack:////Users/wangwenle/Documents/有钱花/搭伙/build-fire/TUIKit/components/TUIChat/message-input/message-input-audio.vue?e0ab"],"names":["__sfc_main","props","isEnableAudio","key","required","type","Boolean","default","setup","__props","__ctx","emits","emit","recordTime","isManualCancelBySlide","recordTimer","firstTouchPageY","isFingerTouchingScreen","isFirstAuthrizedRecord","recorderManager","TUIGlobal","getRecorderManager","isRecording","touchBarText","modalText","isAudioTouchBarShow","currentConversation","recordConfig","duration","sampleRate","numberOfChannels","encodeBitRate","format","switchAudio","onStart","onRecorderStart","onStop","onRecorderStop","onError","onRecorderError","TUIStore","watch","StoreName","CONV","onCurrentConverstaionUpdated","unwatch","conversation","value","initRecorder","initRecorderData","initRecorderView","options","clearInterval","undefined","hasError","stop","handleTouchStart","handleLongPress","start","handleTouchMove","e","pageY","changedTouches","length","offset","handleTouchEnd","setInterval","res","tempFilePath","fileSize","message","TOAST_TYPE","NORMAL","to","groupProfile","groupID","userProfile","userID","conversationType","payload","file","needReadReceipt","TUIChatService","sendAudioMessage","TUITranslateService","audioIcon","components","Object","assign","Icon"],"mappings":"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","file":"TUIKit/components/TUIChat/message-input/message-input-audio.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./message-input-audio.vue?vue&type=template&id=840dc6c6&scoped=true&\"\nvar renderjs\nimport script from \"./message-input-audio.vue?vue&type=script&lang=ts&\"\nexport * from \"./message-input-audio.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./message-input-audio.vue?vue&type=style&index=0&id=840dc6c6&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"840dc6c6\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"TUIKit/components/TUIChat/message-input/message-input-audio.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue2-script-setup!./message-input-audio.vue?vue&type=template&id=840dc6c6&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.props.isEnableAudio\n    ? _vm.TUITranslateService.t(\"TUIChat.\" + _vm.touchBarText)\n    : null\n  var g1 =\n    _vm.props.isEnableAudio && _vm.isRecording\n      ? _vm.TUITranslateService.t(\"TUIChat.\" + _vm.modalText)\n      : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/ts-loader/index.js??ref--14-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--14-2!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue2-script-setup!./message-input-audio.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/ts-loader/index.js??ref--14-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--14-2!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue2-script-setup!./message-input-audio.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { ref, onMounted, onUnmounted } from '../../../adapter-vue';\nimport { TUIStore, StoreName, TUIChatService, SendMessageParams, IConversationModel, TUITranslateService } from '@tencentcloud/chat-uikit-engine';\nimport { TUIGlobal } from '@tencentcloud/universal-api';\nimport throttle from 'lodash/throttle';\nimport Icon from '../../common/Icon.vue';\nimport audioIcon from '../../../assets/icon/audio.svg';\nimport { Toast, TOAST_TYPE } from '../../common/Toast/index';\nimport { isEnabledMessageReadReceiptGlobal } from '../utils/utils';\nimport { InputDisplayType } from '../../../interface';\ninterface IProps {\n  isEnableAudio: boolean;\n}\ninterface IEmits {\n  (e: 'changeDisplayType', type: InputDisplayType): void;\n}\ninterface RecordResult {\n  tempFilePath: string;\n  duration?: number;\n  fileSize?: number;\n}\ntype TouchBarText = '按住说话' | '抬起发送' | '抬起取消';\ntype ModalText = '正在录音' | '继续上滑可取消' | '松开手指 取消发送';\nconst __sfc_main = {};\n__sfc_main.props = {\n  isEnableAudio: {\n    key: \"isEnableAudio\",\n    required: false,\n    type: Boolean,\n    default: false\n  }\n};\n__sfc_main.setup = (__props, __ctx) => {\n  const emits = __ctx.emit;\n  const props = __props;\n  let recordTime: number = 0;\n  let isManualCancelBySlide = false;\n  let recordTimer: number | undefined;\n  let firstTouchPageY: number = -1;\n  let isFingerTouchingScreen = false;\n  let isFirstAuthrizedRecord = false;\n  const recorderManager = TUIGlobal?.getRecorderManager();\n  const isRecording = ref(false);\n  const touchBarText = ref<TouchBarText>('按住说话');\n  const modalText = ref<ModalText>('正在录音');\n  const isAudioTouchBarShow = ref<boolean>(false);\n  const currentConversation = ref<IConversationModel>();\n  const recordConfig = {\n    // 录音的时长，单位 ms，最大值 600000（10 分钟）\n    duration: 60000,\n    // 采样率\n    sampleRate: 44100,\n    // 录音通道数\n    numberOfChannels: 1,\n    // 编码码率\n    encodeBitRate: 192000,\n    // 音频格式，选择此格式创建的音频消息，可以在即时通信 IM 全平台（Android、iOS、微信小程序和Web）互通\n    format: 'mp3'\n  };\n  function switchAudio() {\n    emits('changeDisplayType', props.isEnableAudio ? 'editor' : 'audio');\n  }\n  onMounted(() => {\n    // 为声音录制管理器注册事件\n    recorderManager.onStart(onRecorderStart);\n    recorderManager.onStop(onRecorderStop);\n    recorderManager.onError(onRecorderError);\n    TUIStore.watch(StoreName.CONV, {\n      currentConversation: onCurrentConverstaionUpdated\n    });\n  });\n  onUnmounted(() => {\n    TUIStore.unwatch(StoreName.CONV, {\n      currentConversation: onCurrentConverstaionUpdated\n    });\n  });\n  function onCurrentConverstaionUpdated(conversation: IConversationModel) {\n    currentConversation.value = conversation;\n  }\n  function initRecorder() {\n    initRecorderData();\n    initRecorderView();\n  }\n  function initRecorderView() {\n    isRecording.value = false;\n    touchBarText.value = '按住说话';\n    modalText.value = '正在录音';\n  }\n  function initRecorderData(options?: {\n    hasError: boolean;\n  }) {\n    clearInterval(recordTimer);\n    recordTimer = undefined;\n    recordTime = 0;\n    firstTouchPageY = -1;\n    isManualCancelBySlide = false;\n    if (!options?.hasError) {\n      recorderManager.stop();\n    }\n  }\n  function handleTouchStart() {\n    if (isFingerTouchingScreen) {\n      // 兼容 APP 首次由于用户授权产生的录音需要忽略\n      isFirstAuthrizedRecord = true;\n    }\n  }\n  function handleLongPress() {\n    isFingerTouchingScreen = true;\n    recorderManager.start(recordConfig);\n  }\n  const handleTouchMove = throttle(function (e) {\n    if (isRecording.value) {\n      const pageY = e.changedTouches[e.changedTouches.length - 1].pageY;\n      if (firstTouchPageY < 0) {\n        firstTouchPageY = pageY;\n      }\n      const offset = (firstTouchPageY as number) - pageY;\n      // 录音时的手势上划移动距离对应文案变化\n      if (offset > 150) {\n        touchBarText.value = '抬起取消';\n        modalText.value = '松开手指 取消发送';\n        isManualCancelBySlide = true;\n      } else if (offset > 50) {\n        touchBarText.value = '抬起发送';\n        modalText.value = '继续上滑可取消';\n        isManualCancelBySlide = false;\n      } else {\n        touchBarText.value = '抬起发送';\n        modalText.value = '正在录音';\n        isManualCancelBySlide = false;\n      }\n    }\n  }, 100);\n\n  // 手指离开页面滑动\n  function handleTouchEnd() {\n    isFingerTouchingScreen = false;\n    recorderManager.stop();\n  }\n  function onRecorderStart() {\n    if (!isFingerTouchingScreen) {\n      // 如果开始录音但手指离开屏幕 说明是首次授权弹窗打断了录音 需要忽略\n      isFirstAuthrizedRecord = true;\n      recorderManager.stop();\n      return;\n    }\n    recordTimer = setInterval(() => {\n      recordTime += 1;\n    }, 1000);\n    touchBarText.value = '抬起发送';\n    isRecording.value = true;\n  }\n  function onRecorderStop(res: RecordResult) {\n    if (isFirstAuthrizedRecord) {\n      // 兼容微信首次由于用户授权产生的录音需要忽略 对 APP 无效\n      isFirstAuthrizedRecord = false;\n      initRecorder();\n      return;\n    }\n    if (isManualCancelBySlide || !isRecording.value) {\n      initRecorder();\n      return;\n    }\n    clearInterval(recordTimer);\n    /**\n     * 兼容 uniapp 打包 app\n     * 兼容 uniapp 语音消息没有 duration\n     * duration 和 fileSize 需要用户自己补充\n     * 文件大小 = (音频码率) * 时间长度(单位:秒) / 8\n     * res.tempFilePath 存储录音文件的临时路径\n     */\n    const tempFilePath = res.tempFilePath;\n    const duration = res.duration ? res.duration : recordTime * 1000;\n    const fileSize = res.fileSize ? res.fileSize : 48 * recordTime / 8 * 1024;\n    if (duration < 1000) {\n      Toast({\n        message: '录音时间太短',\n        type: TOAST_TYPE.NORMAL,\n        duration: 1500\n      });\n    } else {\n      const options = ({\n        to: currentConversation?.value?.groupProfile?.groupID || currentConversation?.value?.userProfile?.userID,\n        conversationType: currentConversation?.value?.type,\n        payload: {\n          file: {\n            duration,\n            tempFilePath,\n            fileSize\n          }\n        },\n        needReadReceipt: isEnabledMessageReadReceiptGlobal()\n      } as SendMessageParams);\n      TUIChatService?.sendAudioMessage(options);\n    }\n    initRecorder();\n  }\n  function onRecorderError() {\n    initRecorderData({\n      hasError: true\n    });\n    initRecorderView();\n  }\n  return {\n    TUITranslateService,\n    audioIcon,\n    props,\n    isRecording,\n    touchBarText,\n    modalText,\n    isAudioTouchBarShow,\n    switchAudio,\n    handleTouchStart,\n    handleLongPress,\n    handleTouchMove,\n    handleTouchEnd\n  };\n};\n__sfc_main.components = Object.assign({\n  Icon\n}, __sfc_main.components);\nexport default __sfc_main;\n","import mod from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue2-script-setup!./message-input-audio.vue?vue&type=style&index=0&id=840dc6c6&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue2-script-setup!./message-input-audio.vue?vue&type=style&index=0&id=840dc6c6&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1718595320451\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}