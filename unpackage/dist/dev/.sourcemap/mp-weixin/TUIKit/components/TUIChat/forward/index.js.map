{"version":3,"sources":["webpack:////Users/wangwenle/Documents/有钱花/搭伙/build-fire/TUIKit/components/TUIChat/forward/index.vue?a851","webpack:////Users/wangwenle/Documents/有钱花/搭伙/build-fire/TUIKit/components/TUIChat/forward/index.vue?2f06","webpack:////Users/wangwenle/Documents/有钱花/搭伙/build-fire/TUIKit/components/TUIChat/forward/index.vue?66a2","webpack:////Users/wangwenle/Documents/有钱花/搭伙/build-fire/TUIKit/components/TUIChat/forward/index.vue?43f4","uni-app:///TUIKit/components/TUIChat/forward/index.vue?vue&type=script&lang=ts&"],"names":["__sfc_main","setup","__props","__ctx","isShowForwardPanel","customConversationList","TUIStore","watch","StoreName","CONV","conversationList","onConversationListUpdated","CUSTOM","singleForwardMessageID","onSingleForwardMessageIDUpdated","update","undefined","unwatch","messageID","openForwardPanel","closeForwardPanel","value","finishSelected","selectedConvIDWrapperList","selectedConversationList","map","conversationID","convIDWrapper","userID","getConversationModel","getData","message","getMessageModel","sendMessageOptions","i","length","conversation","offlinePushInfo","TUIChatService","sendForwardMessage","params","needReadReceipt","catch","error","code","TUITranslateService","t","type","TOAST_TYPE","ERROR","onSubmit","convIDWrapperList","list","nick","getShowName","avatar","getAvatar","isUniFrameWork","components","Object","assign","Overlay","Transfer"],"mappings":"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","file":"TUIKit/components/TUIChat/forward/index.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=3808423a&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=ts&\"\nexport * from \"./index.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"TUIKit/components/TUIChat/forward/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue2-script-setup!./index.vue?vue&type=template&id=3808423a&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.TUITranslateService.t(\"TUIChat.转发\")\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/ts-loader/index.js??ref--14-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--14-2!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue2-script-setup!./index.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/ts-loader/index.js??ref--14-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--14-2!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue2-script-setup!./index.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { onMounted, onUnmounted, ref } from '../../../adapter-vue';\nimport { TUIStore, StoreName, TUIChatService, TUITranslateService, IConversationModel } from '@tencentcloud/chat-uikit-engine';\nimport Overlay from '../../common/Overlay/index.vue';\nimport Transfer from '../../common/Transfer/index.vue';\nimport { Toast, TOAST_TYPE } from '../../../components/common/Toast';\nimport { isUniFrameWork } from '../../../utils/env';\nimport { isEnabledMessageReadReceiptGlobal } from '../utils/utils';\nimport { createOfflinePushInfo } from '../utils/sendMessage';\nconst __sfc_main = {};\n__sfc_main.setup = (__props, __ctx) => {\n  const isShowForwardPanel = ref(false);\n  const customConversationList = ref();\n  onMounted(() => {\n    TUIStore.watch(StoreName.CONV, {\n      conversationList: onConversationListUpdated\n    });\n    TUIStore.watch(StoreName.CUSTOM, {\n      singleForwardMessageID: onSingleForwardMessageIDUpdated\n    });\n  });\n  onUnmounted(() => {\n    // 组件卸载时需要清掉数据 否则小程序会自动打开\n    TUIStore.update(StoreName.CUSTOM, 'singleForwardMessageID', undefined);\n    TUIStore.unwatch(StoreName.CONV, {\n      conversationList: onConversationListUpdated\n    });\n    TUIStore.unwatch(StoreName.CUSTOM, {\n      singleForwardMessageID: onSingleForwardMessageIDUpdated\n    });\n  });\n  function onSingleForwardMessageIDUpdated(messageID: string) {\n    if (typeof messageID !== 'undefined') {\n      openForwardPanel();\n    }\n  }\n  function closeForwardPanel(): void {\n    // ! 必须通过close函数关闭转发面板 singleForwardMessage必须清掉\n    TUIStore.update(StoreName.CUSTOM, 'singleForwardMessageID', undefined);\n    isShowForwardPanel.value = false;\n  }\n  function openForwardPanel(): void {\n    isShowForwardPanel.value = true;\n  }\n  function finishSelected(selectedConvIDWrapperList: Array<{\n    userID: string;\n  }>): void {\n    /**\n     * 这里传递的是 coversationID\n     * 但为了实现 Transfer 的复用 这里用 userID 代替 ConversationID\n     */\n    const selectedConversationList = selectedConvIDWrapperList.map(convIDWrapper => {\n      const {\n        userID: conversationID\n      } = convIDWrapper;\n      return TUIStore.getConversationModel(conversationID);\n    });\n    const singleForwardMessageID: string = TUIStore.getData(StoreName.CUSTOM, 'singleForwardMessageID');\n    const message = TUIStore.getMessageModel(singleForwardMessageID);\n    const sendMessageOptions: any = {};\n    for (let i = 0; i < selectedConversationList.length; i++) {\n      const conversation = selectedConversationList[i];\n      const {\n        conversationID\n      } = conversation;\n      sendMessageOptions[conversationID] = {\n        offlinePushInfo: createOfflinePushInfo(conversation)\n      };\n    }\n    TUIChatService.sendForwardMessage(selectedConversationList, [message], {\n      params: {\n        needReadReceipt: isEnabledMessageReadReceiptGlobal()\n      },\n      ...sendMessageOptions\n    }).catch((error: {\n      message: string;\n      code: number;\n    }) => {\n      if (error.code === 80001) {\n        Toast({\n          message: TUITranslateService.t('内容包含敏感词汇'),\n          type: TOAST_TYPE.ERROR\n        });\n      } else {\n        Toast({\n          message: (error.message as string),\n          type: TOAST_TYPE.ERROR\n        });\n      }\n    });\n    closeForwardPanel();\n  }\n  function onSubmit(convIDWrapperList: Array<{\n    userID: string;\n  }>) {\n    if (convIDWrapperList?.length === 0) return;\n    finishSelected(convIDWrapperList);\n  }\n  function onConversationListUpdated(list: IConversationModel[]) {\n    customConversationList.value = list.map(conversation => {\n      return {\n        // 为了实现Transfer的复用，这里用userID代替ConversationID\n        userID: conversation.conversationID,\n        nick: conversation.getShowName(),\n        avatar: conversation.getAvatar()\n      };\n    });\n  }\n  return {\n    TUITranslateService,\n    isUniFrameWork,\n    isShowForwardPanel,\n    customConversationList,\n    closeForwardPanel,\n    onSubmit\n  };\n};\n__sfc_main.components = Object.assign({\n  Overlay,\n  Transfer\n}, __sfc_main.components);\nexport default __sfc_main;\n"],"sourceRoot":""}